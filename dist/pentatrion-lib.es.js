var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,n=Object.getOwnPropertySymbols,o=Object.prototype.propertyIsEnumerable,i=(t,n,o)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o,a=(e,a)=>{for(var r in a||(a={}))t.call(a,r)&&i(e,r,a[r]);if(n)for(var r of n(a))o.call(a,r)&&i(e,r,a[r]);return e};import{notify as r}from"mini-notifier";function s(e,t){let n=document.createElement("a");n.href=URL.createObjectURL(e),n.download=t,document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),document.body.removeChild(n)}var l=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",downloadFromBlob:s,downloadFromUrl:async function(e,t){return fetch(e).then((e=>e.blob())).then((e=>(s(e,t),URL.createObjectURL(e))))},stringToSlug:function(e){e=(e=e.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var t="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",n=0,o=t.length;n<o;n++)e=e.replace(new RegExp(t.charAt(n),"g"),"aaaaeeeeiiiioooouuuunc------".charAt(n));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}});function c(e){return e<10?"0"+e:e}var d=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",toIsoString:function(e,t=!1){let n=e.getUTCFullYear()+"-"+c(e.getUTCMonth()+1)+"-"+c(e.getUTCDate());return t?n+"T"+c(e.getUTCHours())+"-"+c(e.getUTCMinutes()):n},ago:function(e,t){if(!e)return"";t||(t=new Date);let n,o,i=new Date(e),a=Math.floor((t-i)/1e3),r=[Math.floor(a/31536e3),Math.floor(a/2592e3),Math.floor(a/604800),Math.floor(a/86400),Math.floor(a/3600),Math.floor(a/60)],s=["an","mois","semaine","jour","heure","minute"];for(n in r){if(r[n]>1)return o=r[n]+" "+("mois"===s[n]?"mois":s[n]+"s "),"il y a "+o;if(1===r[n])return o=r[n]+" "+s[n]+" ","il y a "+o}return"il y a quelques secondes"}});function u(e,t={},n=!1){var o;t.body instanceof FormData&&(t.body=(o=t.body,Object.fromEntries(o))),"object"==typeof t.body&&(t.body=JSON.stringify(t.body));let i=new Headers({"Content-Type":"application/json",Accept:"application/json"});return n&&i.append("X-Requested-With","XMLHttpRequest"),f(e,t=a({headers:i,method:"POST"},t))}function h(e,t={},n=!1){"object"==typeof t.body&&(t.body=function(e){const t=new FormData;for(let n in e)t.append(n,e[n]);return t}(t.body));let o=new Headers({Accept:"application/json"});return n&&o.append("X-Requested-With","XMLHttpRequest"),f(e,t=a({headers:o,method:"POST"},t))}async function f(e,t={}){let n,o;try{if(n=await fetch(e,t),204===n.status)return null}catch(i){throw new m("Erreur serveur.",401)}if(n.headers.has("Content-Type")&&"application/json"!==n.headers.get("Content-Type")){if(!n.ok)throw new m("Erreur serveur.",500);return n}try{o=await n.json()}catch(i){throw new m("Le contenu renvoyé est illisible.",500)}if(!n.ok){let e=o.err||o.title||o.detail||"Erreur serveur";throw new m(e,n.status)}return o}class m{constructor(e,t=500){this.title=e,this.status=t}}var v=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",jsonFetchOrNotify:async function(e,t={},n=!1){try{return await u(e,t,n)}catch(o){throw r(o instanceof m?o.title:o,{style:"error",time:5e5}),o}},formFetchOrNotify:async function(e,t={},n=!1){try{return await h(e,t,n)}catch(o){throw r(o instanceof m?o.title:o,{style:"error",time:5e5}),o}},jsonFetch:u,formFetch:h,ApiError:m});var p=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",debounceMethod:function(e,t,n){n=n||100;var o=e.prototype[t],i=t+"Timeout";e.prototype[t]=function(){var e=this[i];clearTimeout(e);var t=arguments,a=this;this[i]=setTimeout((function(){o.apply(a,t),delete a[i]}),n)}},throttleMethod:function(e,t,n){n=n||200;let o,i,a=e.prototype[t];e.prototype[t]=function(){var e=+new Date,t=arguments,r=function(){o=e,a.apply(this,t)}.bind(this);o&&e<o+n?(clearTimeout(i),i=setTimeout(r,n)):r()}}});class b{on(e,t){if(e&&t){var n=this._events=this._events||{},o=n[e]=n[e]||[];return-1==o.indexOf(t)&&o.push(t),this}}once(e,t){if(e&&t){this.on(e,t);var n=this._onceEvents=this._onceEvents||{};return(n[e]=n[e]||{})[t]=!0,this}}off(e,t){var n=this._events&&this._events[e];if(n&&n.length){var o=n.indexOf(t);return-1!=o&&n.splice(o,1),this}}emitEvent(e,t){var n=this._events&&this._events[e];if(n&&n.length){n=n.slice(0),t=t||[];for(var o=this._onceEvents&&this._onceEvents[e],i=0;i<n.length;i++){var a=n[i];o&&o[a]&&(this.off(e,a),delete o[a]),a.apply(this,t)}return this}}allOff(){delete this._events,delete this._onceEvents}}function y(e,t={},n=document){if(!e)return;let o=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:t});return n.dispatchEvent(o)}class g{constructor(e={}){this.animation={},this.options=Object.assign({},g.defaultOptions,e)}beforeAnimation(e){e.dataset.animatorId||(e.dataset.animatorId=Math.floor(999999*Math.random()));let t=e.dataset.animatorId;return!this.animation[t]||(this.animation[t].cb(),delete this.animation[t],!1)}animEnter(e){let t;this.beforeAnimation(e);let n=e.dataset.animatorId;t=e.dataset.transitionName?e.dataset.transitionName:this.options.transitionName,e.classList.add(`${t}-enter`),e.classList.add(`${t}-enter-active`),e.classList.remove(this.options.inactiveClass);let o=()=>{e.classList.remove(`${t}-enter-to`),e.classList.remove(`${t}-enter-active`),e.removeEventListener("transitionend",o),delete this.animation[n],console.log("remove listener transitionend",e),console.log("fin animEnter",n)};setTimeout((()=>{e.addEventListener("transitionend",o),e.classList.remove(`${t}-enter`),e.classList.add(`${t}-enter-to`),console.log("add listener transitionend",e.className),this.animation[n]={action:"enter",cb:o}}),10)}animLeave(e){let t;this.beforeAnimation(e);let n=e.dataset.animatorId;t=e.dataset.transitionName?e.dataset.transitionName:this.options.transitionName,e.classList.add(`${t}-leave`),e.classList.add(`${t}-leave-active`);let o=()=>{e.classList.add(this.options.inactiveClass),e.classList.remove(`${t}-leave-to`),e.classList.remove(`${t}-leave-active`),e.removeEventListener("transitionend",o),delete this.animation[n]};setTimeout((()=>{e.addEventListener("transitionend",o),e.classList.remove(`${t}-leave`),e.classList.add(`${t}-leave-to`),this.animation[n]={action:"leave",cb:o}}),10)}}g.defaultOptions={inactiveClass:"hide",transitionName:"transition"};export{g as Animator,b as EventEmitter,v as apiHelper,d as dateHelper,l as downloadHelper,y as emitEvent,p as functionHelper};
