var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,r=Object.getOwnPropertySymbols,o=Object.prototype.propertyIsEnumerable,n=(t,r,o)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o,a=(e,a)=>{for(var c in a||(a={}))t.call(a,c)&&n(e,c,a[c]);if(r)for(var c of r(a))o.call(a,c)&&n(e,c,a[c]);return e};import{notify as c}from"mini-notifier";function i(e,t){let r=document.createElement("a");r.href=URL.createObjectURL(e),r.download=t,document.body.appendChild(r),r.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),document.body.removeChild(r)}var l=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",downloadFromBlob:i,downloadFromUrl:async function(e,t){return fetch(e).then((e=>e.blob())).then((e=>(i(e,t),URL.createObjectURL(e))))},stringToSlug:function(e){e=(e=e.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var t="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",r=0,o=t.length;r<o;r++)e=e.replace(new RegExp(t.charAt(r),"g"),"aaaaeeeeiiiioooouuuunc------".charAt(r));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}});function u(e){return e<10?"0"+e:e}var s=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",toIsoString:function(e,t=!1){let r=e.getUTCFullYear()+"-"+u(e.getUTCMonth()+1)+"-"+u(e.getUTCDate());return t?r+"T"+u(e.getUTCHours())+"-"+u(e.getUTCMinutes()):r}});function p(e,t={},r=!1){if(!t.body)throw new h("No content to fetch",500);var o;t.body instanceof FormData&&(t.body=(o=t.body,Object.fromEntries(o))),"object"==typeof t.body&&(t.body=JSON.stringify(t.body));let n=new Headers({"Content-Type":"application/json",Accept:"application/json"});return r&&n.append("X-Requested-With","XMLHttpRequest"),d(e,t=a({headers:n,method:"POST"},t))}function f(e,t={},r=!1){if(!t.body)throw new h("No content to fetch",500);"object"==typeof t.body&&(t.body=function(e){const t=new FormData;for(let r in e)t.append(r,e[r]);return t}(t.body));let o=new Headers({Accept:"application/json"});return r&&o.append("X-Requested-With","XMLHttpRequest"),d(e,t=a({headers:o,method:"POST"},t))}async function d(e,t={}){let r,o;try{if(r=await fetch(e,t),204===r.status)return null}catch(n){throw new h("Erreur serveur.",401)}if(r.headers.has("Content-Type")&&"application/json"!==r.headers.get("Content-Type")){if(!r.ok)throw new h("Erreur serveur.",500);return r}try{o=await r.json()}catch(n){throw new h("Le contenu renvoyé est illisible.",500)}if(!r.ok){let e=o.err||o.title||o.detail||"Erreur serveur";throw new h(e,r.status)}return o}class h{constructor(e,t=500){this.title=e,this.status=t}}var y=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",jsonFetchOrNotify:async function(e,t={},r=!1){try{return await p(e,t,r)}catch(o){throw c(o instanceof h?o.title:o,{style:"error",time:5e5}),o}},formFetchOrNotify:async function(e,t={},r=!1){try{return await f(e,t,r)}catch(o){throw c(o instanceof h?o.title:o,{style:"error",time:5e5}),o}},jsonFetch:p,formFetch:f,ApiError:h});export{y as apiHelper,s as dateHelper,l as downloadHelper};
